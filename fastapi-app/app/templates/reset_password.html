<!DOCTYPE html>
<html>

<head>
    <title>Reset Password</title>
</head>

<body>
    <h2>Reset Password</h2>
    <form id="resetForm">
        <input type="hidden" id="access_token" name="access_token">
        <input type="hidden" id="refresh_token" name="refresh_token">
        <label for="new_password">New Password:</label>
        <input type="password" id="new_password" name="new_password" required>
        <button type="submit">Reset Password</button>
    </form>

    <script>
        // Extract access_token from URL hash
        const hashParams = new URLSearchParams(window.location.hash.slice(1));
        document.getElementById('access_token').value = hashParams.get('access_token');
        document.getElementById('refresh_token').value = hashParams.get('refresh_token');
        document.getElementById('resetForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const response = await fetch('/auth/reset-password', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    access_token: document.getElementById('access_token').value,
                    refresh_token: document.getElementById('refresh_token').value,
                    new_password: document.getElementById('new_password').value,
                }),
            });
            const result = await response.json();
            if (response.ok) {
                document.body.innerHTML = `<h2>Password Reset Result</h2><p>${result.message}</p>`;
            } else {
                document.body.innerHTML = `<h2>Error</h2><p>${result.detail || 'An error occurred during password reset.'}</p>`;
            }
        });
    </script>
</body>

</html>